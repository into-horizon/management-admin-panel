import{r as x,n as F,j as e,ab as y,aC as T,aD as E,aE as S,ac as g,P as D,Q as a,af as n,aG as M,bZ as N,b_ as B,b$ as I,m as R,bB as l,ae as b,aF as P}from"./index-48Ud3P6g.js";import{C as w}from"./index.esm-CyPqoXYn.js";import{c as $}from"./cil-plus-DmDyxMpI.js";import{F as H,a as L}from"./FilterCard-D5uFsBWP.js";import{T as U}from"./Table-BMwozXSY.js";import{c as A}from"./connect-C6z2JEc3.js";import"./cil-filter-x-DEIlHx5l.js";import"./cil-search-C59ySTwT.js";import"./Paginator-C-gW1K4z.js";import"./lodash-BeNFXnYs.js";import"./cil-check-CLln4ywF.js";const O=({callback:o,params:j})=>{const[p,d]=x.useState(!1),[m,i]=x.useState(0),C=F(),_=["01","02","03","04","05","06","07","08","09","10","11","12"],c=r=>{var u;r.preventDefault();const t=r.target;let s={discount_code:"",expiry_date:"",max_counter:0,discount:0,max_discount:0,number_of_time:0};s.discount=Number(t.discount.value),s.discount_code=t.discount_code.value,s.expiry_date=t.expiry_date.value,s.max_counter=parseInt(t.max_counter.value),s.max_discount=parseInt(t.max_counter.value),s.number_of_time=parseInt(((u=t.number_of_time)==null?void 0:u.value)??"0"),s.min_order_amount=parseInt(t.min_order_amount.value),C(N(s)),d(!1),t.reset(),o==null||o(j),i(0)},f=r=>{r.target.reset(),i(0),d(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(y,{onClick:()=>d(!0),children:[e.jsx(w,{icon:$}),"Create Discount Code"]}),e.jsxs(T,{visible:p,alignment:"center",onClose:()=>d(!1),children:[e.jsx(E,{children:e.jsx(S,{children:"Create Discount Code"})}),e.jsxs(g,{onSubmit:c,onReset:f,children:[e.jsxs(D,{className:"justify-content-center align-content-center",xs:{gutter:3},children:[e.jsx(a,{xs:"auto",children:e.jsx(n,{placeholder:"code title",id:"discount_code"})}),e.jsx(a,{xs:"auto",children:e.jsx(n,{type:"date",id:"expiry_date",placeholder:"expiry date",min:`${new Date().getFullYear()}-${_[new Date().getMonth()]}-${new Date().getDate()}`})}),e.jsx(a,{xs:"auto",children:e.jsx(n,{type:"number",id:"min_order_amount",placeholder:"min order amount"})}),e.jsx(a,{xs:"auto",children:e.jsx(n,{type:"number",id:"max_counter",step:"1",min:1,placeholder:"max counter"})}),e.jsx(a,{xs:10,children:e.jsx(n,{type:"number",id:"discount",step:.01,placeholder:"discount amount or percentage",min:0,value:m,onChange:r=>i(parseInt(r.target.value))})}),e.jsx(a,{xs:10,children:e.jsx(n,{type:"number",id:"max_discount",placeholder:"max discount amount",min:0,required:m<1,disabled:m>=1})}),e.jsx(a,{xs:"auto",children:e.jsx(n,{type:"number",id:"number_of_time",step:1,min:1,placeholder:"usage per user"})})]}),e.jsxs(M,{children:[e.jsx(y,{type:"submit",children:"submit"}),e.jsx(y,{color:"secondary",type:"reset",children:"close"})]})]})]})]})},V=({getDiscountCodesHandler:o,updateDiscountCodeHandler:j})=>{const p={limit:10,offset:0},{data:d,count:m}=R(t=>t.discountCode),[i,C]=x.useState(p),[_,c]=x.useState(!0);x.useEffect(()=>{o(i).then(()=>c(!1))},[]);const f=[{header:"name",field:"discount_code"},{header:"counter",field:"counter"},{header:"max counter",field:"max_counter",edit:{inputType:l.NUMBER}},{header:"discount",field:"discount"},{header:"max discount",field:"max_discount",edit:{inputType:l.NUMBER}},{header:"max usage per user",field:"number_of_time",edit:{inputType:l.NUMBER}},{header:"expiry data",field:"expiry_date",body:t=>new Date(t.expiry_date).toLocaleDateString(),edit:{inputType:l.DATE}},{header:"min order amount",field:"min_order_amount",edit:{inputType:l.NUMBER}},{header:"active",field:"active",body:t=>t.active.toString(),edit:{inputType:l.DROPDOWN,options:[{value:"false",name:"deactivate"},{value:"true",name:"activate"}]}}],r=t=>{t.preventDefault(),c(!0);const s=["discount_code","expiry_date","active"],u=t.target;let v={...p};s.forEach(h=>{u[h].value&&u[h].value!==""&&(v[h]=u[h].value)}),o(v).then(()=>{c(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(O,{callback:o,params:i}),e.jsx(H,{children:e.jsx(g,{onSubmit:r,children:e.jsxs(D,{className:"justify-content-center align-items-end",xs:{gutterY:3},children:[e.jsx(a,{xs:"auto",children:e.jsx(n,{placeholder:"code name",id:"discount_code"})}),e.jsxs(a,{xs:"auto",children:[e.jsx(b,{htmlFor:"active",children:"Active"}),e.jsxs(P,{name:"active",id:"active",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"true",children:"true"}),e.jsx("option",{value:"false",children:"false"})]})]}),e.jsxs(a,{xs:"auto",children:[e.jsx(b,{htmlFor:"expiry_date",children:"Expiry Date Before"}),e.jsx(n,{name:"expiry_date",type:"date",id:"expiry_date"})]}),e.jsx(a,{xs:12,children:e.jsx(L,{})})]})})}),e.jsx(U,{params:i,loading:_,columns:f,data:d,count:m,cookieName:"codes",changeData:o,updateLoading:c,editable:!0,editFn:j})]})},Y={getDiscountCodesHandler:I,updateDiscountCodeHandler:B},te=A(null,Y)(V);export{te as default};
