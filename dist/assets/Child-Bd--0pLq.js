import{m as B,r as i,n as L,bg as M,bB as c,j as e,bD as N,ac as k,P as z,Q as l,af as G,aa as d,ab as p,bE as Q,bF as f,bG as C,bH as q,R as J,bI as K}from"./index-48Ud3P6g.js";import{T as O}from"./Table-BMwozXSY.js";import{c as U}from"./cil-filter-x-DEIlHx5l.js";import{c as W}from"./cil-search-C59ySTwT.js";import{c as Y}from"./cil-trash-Bi1lSbbJ.js";import{C as u}from"./index.esm-CyPqoXYn.js";import{F as Z}from"./FilterCard-D5uFsBWP.js";import{S as V}from"./SearchDropdown-CwB1jFTy.js";import{A as tt}from"./AddCategoryModal-XKOgx4G_.js";import{D as et}from"./DeleteModal-Bo2mqpaY.js";import"./Paginator-C-gW1K4z.js";import"./lodash-BeNFXnYs.js";import"./cil-check-CLln4ywF.js";import"./cil-plus-DmDyxMpI.js";const Ct=()=>{const{childCategories:{data:x,count:j},parentCategories:{data:y},childParams:n,isLoading:b}=B(t=>t.category),[S,m]=i.useState([]),[T,h]=i.useState(!1),[D,F]=i.useState(1),[a,g]=i.useState(null),[at,E]=i.useState(!1),o=L();i.useEffect(()=>{!(a!=null&&a.id)&&E(!0)},[a==null?void 0:a.id]),i.useEffect(()=>{o(M())},[n]);const P=({id:t})=>{const[s,r]=i.useState(!1),w=async()=>{o(K(t)),r(!1)};return e.jsxs(J.Fragment,{children:[e.jsx(et,{visible:s,onClose:()=>r(!1),onDelete:w}),e.jsx(d,{content:"Delete",children:e.jsx(p,{color:"danger",onClick:()=>r(!0),children:e.jsx(u,{icon:Y})})})]})},H=[{header:"english title",field:"entitle",edit:{inputType:c.TEXT}},{header:"arabic title",field:"artitle",edit:{inputType:c.TEXT}},{header:"parent title",field:"p_artitle",body:t=>{var s,r;return`${(s=t.parent_category)==null?void 0:s.entitle} - ${(r=t.parent_category)==null?void 0:r.artitle}`}},{header:"meta title",field:"metatitle",body:t=>t.metatitle?t.metatitle:"-",edit:{inputType:c.TEXT}},{header:"products count",field:"products_count"}],R=t=>{g(t)},_=async t=>{h(!0);try{const{data:{data:s}}=await q.getAllParentCategoires({title:t});m(s)}finally{h(!1)}},v=t=>{_(t)},A=t=>{t.preventDefault();const s=t.target,r={};a!=null&&a.id&&(r.parent_id=a.id),s.title.value&&(r.title=s.title.value),o(f()),o(C(r))},I=t=>{const s=t.target;g(null),s.reset(),o(f())};i.useEffect(()=>{m(y)},[]);const X=t=>e.jsx(i.Fragment,{children:e.jsx(P,{...t})}),$=t=>{o(C({offset:((n==null?void 0:n.limit)??10)*(t-1)})),F(t)};return e.jsxs(e.Fragment,{children:[e.jsx(tt,{action:t=>o(N(t)),type:"child"}),e.jsx(Z,{children:e.jsx(k,{onSubmit:A,onReset:I,children:e.jsxs(z,{className:"justify-content-center align-items-end",children:[e.jsx(l,{xs:"auto",children:e.jsx(G,{id:"title",placeholder:"title"})}),e.jsx(l,{xs:"auto",children:e.jsx(V,{options:S.map(t=>({id:t.id,title:`${t.entitle} - ${t.artitle}`})),selectedValue:a,onSelect:R,loading:T,onChange:v,placeholder:"search for parent category",delay:1e3})}),e.jsx(l,{xs:"auto",children:e.jsx(d,{content:"search",children:e.jsx(p,{type:"submit",children:e.jsx(u,{icon:W})})})}),e.jsx(l,{xs:"auto",children:e.jsx(d,{content:"clear filter",children:e.jsx(p,{color:"secondary",type:"reset",children:e.jsx(u,{icon:U})})})})]})})}),e.jsx(O,{data:x,count:j,columns:H,pageSize:n.limit,pageNumber:D,loading:b,editFn:Q,onPageChange:$,editable:!0,Actions:X})]})};export{Ct as default};
