import{aA as W,aB as I,d as k,j as e,aC as L,aD as M,aE as D,ac as N,P as v,Q as m,af as C,aF as Z,aG as _,ab as j,r as d,n as P,aa as F,ae as S,aH as R,m as w,aI as B,aJ as A,aK as O,aL as H,aM as U,aN as z}from"./index-48Ud3P6g.js";import{C as p}from"./index.esm-CyPqoXYn.js";import{c as T}from"./cil-check-CLln4ywF.js";import{c as G}from"./cil-external-link-2XtDvLdz.js";import{c as J}from"./connect-C6z2JEc3.js";import{c as K,T as Q}from"./Table-BMwozXSY.js";import"./Paginator-C-gW1K4z.js";import"./lodash-BeNFXnYs.js";const X=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M334.627,16H48V496H472V153.373ZM440,166.627V168H320V48h1.373ZM80,464V48H288V200H440V464Z' class='ci-primary'/>"],Y=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M153.456,472A136,136,0,0,1,57.289,239.834l196.6-196.6L276.52,65.857l-196.6,196.6A104,104,0,0,0,227,409.539L434.912,201.622A72,72,0,0,0,333.088,99.8L125.171,307.716a40,40,0,1,0,56.568,56.568L361.373,184.652,384,207.279,204.367,386.911A72,72,0,1,1,102.544,285.089L310.461,77.172A104,104,0,1,1,457.539,224.249L249.622,432.166A135.1,135.1,0,0,1,153.456,472Z' class='ci-primary'/>"],$=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M441.885,141.649A32.028,32.028,0,0,0,415.669,128H336V80a32.036,32.036,0,0,0-32-32H48A32.036,32.036,0,0,0,16,80V408H69.082a67.982,67.982,0,0,0,133.836,0H309.082a67.982,67.982,0,0,0,133.836,0H496V226.522a23.882,23.882,0,0,0-4.338-13.763ZM47.98,80H304V256H48ZM136,432a36,36,0,1,1,36-36A36.04,36.04,0,0,1,136,432Zm240,0a36,36,0,1,1,36-36A36.04,36.04,0,0,1,376,432Zm88-56H440.994a68,68,0,0,0-129.988,0H200.994a68,68,0,0,0-129.988,0H48V288H464Zm0-120H336V160h79.669L464,229.044Z' class='ci-primary'/>"],ee=({add:g,update:h,addAccountHandler:l,updateAccountHandler:i,account:s,onClose:o})=>{const{t:u}=k("translation",{keyPrefix:"globals"}),{t}=k("translation",{keyPrefix:"bankAccount"}),y=x=>{const n=x.target;x.preventDefault();let f={title:n.title.value,type:n.type.value,reference:n.referenceNumber.value,id:""};Promise.all([h&&s?i==null?void 0:i({...f,id:s==null?void 0:s.id}):l==null?void 0:l(f)]).then(()=>o())};return e.jsxs(L,{onClose:o,visible:g||h,alignment:"center",children:[e.jsx(M,{children:e.jsx(D,{children:t("transferAccount")})}),e.jsxs(N,{onSubmit:y,children:[e.jsxs(v,{xs:{gutterY:3},className:"mrgn50 justify-content-md-center",children:[e.jsx(m,{xs:8,children:e.jsx(C,{id:"title",placeholder:t("title"),required:!0,defaultValue:s?s.title:""})}),e.jsx(m,{xs:8,children:e.jsxs(Z,{id:"type",required:!0,defaultValue:s?s.type:"",children:[e.jsx("option",{value:"bank Account",children:t("bankAccount")}),e.jsx("option",{value:"Cliq",children:t("cliq")}),e.jsx("option",{value:"e-wallet",children:t("ewallet")})]})}),e.jsx(m,{xs:8,children:e.jsx(C,{id:"referenceNumber",placeholder:t("reference"),defaultValue:s?s.reference:"",required:!0})})]}),e.jsxs(_,{children:[e.jsx(j,{color:"secondary",type:"button",onClick:o,children:u("close")}),h?e.jsx(j,{color:"primary",type:"submit",children:u("saveChanges")}):e.jsx(j,{color:"primary",type:"submit",children:u("add")})]})]})]})},ae={addAccountHandler:I,updateAccountHandler:W},te=J(null,ae)(ee),se=g=>{const[h,l]=d.useState(!1),[i,s]=d.useState(""),[o,u]=d.useState(""),[t,y]=d.useState(null),x=P(),n=r=>{s(r),l(!0)};d.useEffect(()=>{console.log({file:t})},[t]);const f=r=>{var V;const a=r.target;let c=new FormData,E={...g,status:i==="accept"?"transferred":"rejected",rejection_reason:o?o==="other"?a.rejection_reason_other.value:a.rejection_reason.value:null,document:(V=a.document)==null?void 0:V.files[0]};Object.entries(E).forEach(([q,b])=>{typeof b=="number"&&(b=String(b)),b&&c.append(q,b)}),r.preventDefault(),x(R(c))};return e.jsxs(e.Fragment,{children:[e.jsx(F,{content:"accept",children:e.jsx(j,{color:"success",onClick:()=>n("accept"),children:e.jsx(p,{icon:T})})}),e.jsx(F,{content:"reject",children:e.jsx(j,{color:"danger",onClick:()=>n("reject"),children:e.jsx(p,{icon:K})})}),e.jsxs(L,{visible:h,alignment:"center",onClose:()=>l(!1),children:[e.jsx(M,{children:e.jsx(D,{children:"Update withdrawal"})}),e.jsxs(N,{onSubmit:f,children:[e.jsx(v,{className:"justify-content-center align-items-center",children:e.jsxs(m,{xs:"auto ",className:"file-label",children:[i==="accept"&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{style:{margin:"auto"},htmlFor:"document",className:"btn btn-primary",children:[" ",e.jsx(p,{icon:X,size:"lg"}),"upload document"]}),e.jsx(C,{name:"document",id:"document",type:"file",hidden:!0,accept:".jpeg, .png, .pdf",onChange:r=>y(r.target.files?r.target.files[0]:null)}),e.jsx(C,{value:t!=null&&t.name?t==null?void 0:t.name:"",readOnly:!0,placeholder:"file name"})]}),i==="reject"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{htmlFor:"rejection",children:"rejection reason"}),e.jsxs(Z,{id:"rejection_reason",onChange:r=>u(r.target.value),defaultValue:"invalid amount",children:[e.jsx("option",{value:"invalid amount",children:"invalid amount"}),e.jsx("option",{value:"incorrect bank details",children:"incorrect bank details"}),e.jsx("option",{value:"other",children:"other"})]}),o==="other"&&e.jsx(C,{placeholder:"enter reason",id:"rejection_reason_other",required:!0})]})]})}),e.jsxs(_,{children:[e.jsx(j,{color:"primary",type:"submit",children:"submit"}),e.jsx(j,{color:"secondary",onClick:()=>l(!1),children:"close"})]})]})]})]})},he=()=>{const{commission:g,delivery:h,transferred:l}=w(a=>a.finance),{loading:i}=w(a=>a.finance),{data:s,count:o,loading:u,params:t}=w(a=>a.withdrawals),[y,x]=d.useState(!1),n=P(),f=[{header:"transfer to",field:"title"},{header:"amount",field:"amount"},{header:"status",field:"status"},{header:"created at",body:a=>{var c;return e.jsx("span",{children:(c=new Date(a.created_at))==null?void 0:c.toLocaleDateString()})}},{header:"updated at",body:a=>{var c;return e.jsx("span",{children:a.updated?(c=new Date(a.updated))==null?void 0:c.toLocaleDateString():"-"})}},{header:"attachment",body:a=>a.document?e.jsx("a",{href:a.document,target:"_blank",children:e.jsx(p,{icon:Y})}):"-"},{header:"action",body:a=>a.status==="requested"?e.jsx(se,{...a}):e.jsx("span",{children:"completed"})}],r=a=>{n(U(z(t,a)))};return d.useEffect(()=>{n(B())},[]),d.useEffect(()=>{n(A())},[t]),i?e.jsx(O,{}):e.jsxs(e.Fragment,{children:[e.jsx(te,{add:y,onClose:()=>x(!1)}),e.jsxs(v,{children:[e.jsx(m,{lg:4,md:4,xs:12,sm:4,children:e.jsx(H,{className:"mb-3",color:"success",icon:e.jsx(p,{icon:T,height:24}),padding:!1,title:"commission",value:g})}),e.jsx(m,{lg:4,md:4,xs:12,sm:4,children:e.jsx(H,{className:"mb-3",color:"warning",icon:e.jsx(p,{icon:$,height:24}),padding:!1,title:"delivery",value:h})}),e.jsx(m,{lg:4,md:4,xs:12,sm:4,children:e.jsx(H,{className:"mb-3",color:"info",icon:e.jsx(p,{icon:G,height:24}),padding:!1,title:"transferred",value:l})})]}),e.jsx(v,{className:"justify-content-md-center mgn-top50",children:e.jsx(m,{xs:12,lg:10,xl:8,children:e.jsx(Q,{columns:f,data:s,count:o,changeData:A,cookieName:"withdrawal",loading:u,onPageChange:r})})})]})};export{he as default};
